<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>The exploration’s report</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="site_libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-binding-2.0.2/leaflet.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">FGV MBA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="01_exploration_report.html">Exploration</a>
</li>
<li>
  <a href="02_logistic_regression_report.html">Loan Logistic Regression</a>
</li>
<li>
  <a href="03_conclusion.html">Conclusion</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">The exploration’s report</h1>
<h4 class="date">July, 2019</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#setting-the-scene"><span class="toc-section-number">1</span> Setting the scene</a><ul>
<li><a href="#introduction"><span class="toc-section-number">1.1</span> Introduction</a></li>
<li><a href="#task-descripion"><span class="toc-section-number">1.2</span> Task descripion</a></li>
<li><a href="#data-description"><span class="toc-section-number">1.3</span> Data description</a></li>
</ul></li>
<li><a href="#data-ingestion-cleaning-translation-and-enhancement"><span class="toc-section-number">2</span> Data ingestion, cleaning, translation and enhancement</a><ul>
<li><a href="#create-functions"><span class="toc-section-number">2.1</span> Create Functions</a><ul>
<li><a href="#getgenderfrombirthnumber"><span class="toc-section-number">2.1.1</span> GetGenderFromBirthnumber</a></li>
<li><a href="#getbirthdatefrombirthnumber"><span class="toc-section-number">2.1.2</span> GetBirthdateFromBirthnumber</a></li>
<li><a href="#converttodate"><span class="toc-section-number">2.1.3</span> ConvertToDate</a></li>
<li><a href="#getagefrombirthnumber"><span class="toc-section-number">2.1.4</span> GetAgeFromBirthnumber</a></li>
</ul></li>
<li><a href="#data-ingestion"><span class="toc-section-number">2.2</span> Data Ingestion</a></li>
<li><a href="#data-cleaning"><span class="toc-section-number">2.3</span> Data Cleaning</a></li>
<li><a href="#label-translation"><span class="toc-section-number">2.4</span> Label Translation</a></li>
<li><a href="#data-enhancement"><span class="toc-section-number">2.5</span> Data Enhancement</a></li>
</ul></li>
<li><a href="#the-explorations"><span class="toc-section-number">3</span> The explorations</a><ul>
<li><a href="#gender-exploration"><span class="toc-section-number">3.1</span> Gender Exploration</a></li>
<li><a href="#loan-exploration"><span class="toc-section-number">3.2</span> Loan Exploration</a></li>
<li><a href="#account-balance-exploration"><span class="toc-section-number">3.3</span> Account Balance Exploration</a></li>
<li><a href="#district-exploration"><span class="toc-section-number">3.4</span> District exploration</a></li>
</ul></li>
</ul>
</div>

<div id="setting-the-scene" class="section level1">
<h1><span class="header-section-number">1</span> Setting the scene</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<p>Onde upon a time, there was a bank offering services to private persons. The services include managing of accounts, offerings loans, etc.</p>
</div>
<div id="task-descripion" class="section level2">
<h2><span class="header-section-number">1.2</span> Task descripion</h2>
<p>The bank wants to improve their services. For instance, the bank managers have only vague idea, who is a good client (whom to offer some additional services) and who is a bad client (whom to watch carefully to monimize the bank loses).</p>
<p>Fortunately, the bank stores data about their clients, the accounts (transactions within several months), the loans already granted, the credit cards issued.</p>
<p>The bank managers hope to improve their undestanding of customers and seed specific actions to improve services. A mere application of discovery tool will not be convincing for them.</p>
</div>
<div id="data-description" class="section level2">
<h2><span class="header-section-number">1.3</span> Data description</h2>
<p>This database was prepared by Petr Berka and Marta Sochorova.</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/ldaniel/R_Bank_Berka/master/images/data_model.png" alt="Simplified logical data model of Berka Bank." />
<p class="caption">Simplified logical data model of Berka Bank.</p>
</div>
<hr />
</div>
</div>
<div id="data-ingestion-cleaning-translation-and-enhancement" class="section level1">
<h1><span class="header-section-number">2</span> Data ingestion, cleaning, translation and enhancement</h1>
<p>Before starting the Berka Analysis, a few important steps were taken in order to prepare the source data files. These steps are listed below:</p>
<ul>
<li><strong>Step 01</strong>: Create Functions;</li>
<li><strong>Step 02</strong>: Data Ingestion;</li>
<li><strong>Step 03</strong>: Data Cleaning;</li>
<li><strong>Step 04</strong>: Label Translation;</li>
<li><strong>Step 05</strong>: Data Enhancement.</li>
</ul>
<div id="create-functions" class="section level2">
<h2><span class="header-section-number">2.1</span> Create Functions</h2>
<p>This step create functions to be used in the next steps. Following, all functions created are described.</p>
<div id="getgenderfrombirthnumber" class="section level3">
<h3><span class="header-section-number">2.1.1</span> GetGenderFromBirthnumber</h3>
<p>The birth_number column is given in the form of YYMMDD for men, and YYMM+50DD for women. The objective of this function is to return the gender of the client via the birth_number.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">GetGenderFromBirthnumber &lt;-<span class="st"> </span><span class="cf">function</span>(var_birth_number) {</a>
<a class="sourceLine" id="cb1-2" title="2">  month &lt;-<span class="st"> </span><span class="kw">substr</span>(var_birth_number, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">  result &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">as.integer</span>(month) <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">  </a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="kw">return</span>(<span class="kw">as.factor</span>(result))</a>
<a class="sourceLine" id="cb1-6" title="6">}</a></code></pre></div>
</div>
<div id="getbirthdatefrombirthnumber" class="section level3">
<h3><span class="header-section-number">2.1.2</span> GetBirthdateFromBirthnumber</h3>
<p>The birth_number column is given in the form of YYMMDD for men, # and YYMM+50DD for women. The objective of this function is to return the final birthday as Date.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">GetBirthdateFromBirthnumber &lt;-<span class="st"> </span><span class="cf">function</span>(var_birth_number, var_gender) {</a>
<a class="sourceLine" id="cb2-2" title="2">  year &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;19&quot;</span>, <span class="kw">substr</span>(var_birth_number, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">  month &lt;-<span class="st"> </span><span class="kw">ifelse</span>(var_gender <span class="op">==</span><span class="st"> &quot;male&quot;</span>, <span class="kw">substr</span>(var_birth_number, <span class="dv">3</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="kw">as.integer</span>(<span class="kw">substr</span>(var_birth_number, <span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">  day &lt;-<span class="st"> </span><span class="kw">substr</span>(var_birth_number, <span class="dv">5</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb2-6" title="6">  result &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">paste</span>(year, <span class="st">&quot;-&quot;</span>, month, <span class="st">&quot;-&quot;</span>, day, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">  </a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb2-9" title="9">}</a></code></pre></div>
</div>
<div id="converttodate" class="section level3">
<h3><span class="header-section-number">2.1.3</span> ConvertToDate</h3>
<p>The objective of this function is to convert the strange bank date style to the regular R Date datatype.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">ConvertToDate &lt;-<span class="st"> </span><span class="cf">function</span>(var_date) {</a>
<a class="sourceLine" id="cb3-2" title="2">  year &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;19&quot;</span>, <span class="kw">substr</span>(var_date, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">  month &lt;-<span class="st"> </span><span class="kw">substr</span>(var_date, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">  day &lt;-<span class="st"> </span><span class="kw">substr</span>(var_date, <span class="dv">5</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb3-5" title="5">  result &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">paste</span>(year, <span class="st">&quot;-&quot;</span>, month, <span class="st">&quot;-&quot;</span>, day, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb3-6" title="6">  </a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb3-8" title="8">}</a></code></pre></div>
</div>
<div id="getagefrombirthnumber" class="section level3">
<h3><span class="header-section-number">2.1.4</span> GetAgeFromBirthnumber</h3>
<p>The objective of this function is to get age given the birth_number.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">GetAgeFromBirthnumber &lt;-<span class="st"> </span><span class="cf">function</span>(var_birth_number) {</a>
<a class="sourceLine" id="cb4-2" title="2">  base_year &lt;-<span class="st"> </span><span class="dv">99</span> <span class="co"># considering 1999 as the base year for this exercise</span></a>
<a class="sourceLine" id="cb4-3" title="3">  year &lt;-<span class="st"> </span><span class="kw">substr</span>(var_birth_number, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">  result &lt;-<span class="st"> </span>base_year <span class="op">-</span><span class="st"> </span><span class="kw">as.integer</span>(year)</a>
<a class="sourceLine" id="cb4-5" title="5">  </a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb4-7" title="7">}</a></code></pre></div>
</div>
</div>
<div id="data-ingestion" class="section level2">
<h2><span class="header-section-number">2.2</span> Data Ingestion</h2>
<p>The process of data ingestion — preparing data for analysis — usually includes steps called extract (taking the data from its current location), transform (cleansing and normalizing the data), and load (placing the data in a database where it can be analyzed).</p>
<p>During this step, in addition to the loading data processes, it was performed data casting, column renaming and small touch-ups. The list below describe each table adjustment taken:</p>
<ul>
<li><strong>District</strong>: renaming columns and casting columns with decimal or “?” values;</li>
<li><strong>Credit Card</strong>: casting column issued in creditcard table from string to datetime data type;</li>
<li><strong>Account</strong>: casting column date in account table from string to datetime data type;</li>
<li><strong>Loan</strong>: casting columns in table loan to the right data types;</li>
<li><strong>Permanent Order</strong>: casting columns with decimal values;</li>
<li><strong>Transaction</strong>: casting columns in table transaction to the right data types.</li>
</ul>
</div>
<div id="data-cleaning" class="section level2">
<h2><span class="header-section-number">2.3</span> Data Cleaning</h2>
<p>The objective of this step is analysing missing values and other strange conditions. In order to accomplish this task, a few R functions were used to quickly discover missing values, like NA and empty fields.</p>
<p>First thing done, was fixing observations in k_symbol transaction table with ’ ’ (one space) to empty string (’’), using the following command.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">transaction<span class="op">$</span>k_symbol =<span class="st"> </span><span class="kw">trimws</span>(transaction<span class="op">$</span>k_symbol)</a></code></pre></div>
<p>Then, the command below was used to find out any NA values in each table.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">sapply</span>(TableName, <span class="cf">function</span>(x) <span class="kw">sum</span>(<span class="kw">is.na</span>(x)))</a></code></pre></div>
<p>Solely the <strong>transaction</strong> table has NA values, in the following columns:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trans_id</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>account_id</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>date</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>type</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>operation</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>amount</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>balance</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>k_symbol</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>bank</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>account</td>
<td align="right">760931</td>
</tr>
</tbody>
</table>
<p>Finally, the following command was used in each table to find out where empty values was hidden.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">sapply</span>(TableName, <span class="cf">function</span>(x) <span class="kw">table</span>(<span class="kw">as.character</span>(x) <span class="op">==</span><span class="st">&quot;&quot;</span>)[<span class="st">&quot;TRUE&quot;</span>])</a></code></pre></div>
<p>Again, only the <strong>transaction</strong> table had empty values, according to the table below:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trans_id.NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>account_id.NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>date.NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>type.NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>operation.TRUE</td>
<td align="right">183114</td>
</tr>
<tr class="even">
<td>amount.NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>balance.NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>k_symbol.TRUE</td>
<td align="right">535314</td>
</tr>
<tr class="odd">
<td>bank.TRUE</td>
<td align="right">782812</td>
</tr>
<tr class="even">
<td>account.NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>For the exploration analysis report, we did not take any additional action, since the missing values was not relevant.</p>
</div>
<div id="label-translation" class="section level2">
<h2><span class="header-section-number">2.4</span> Label Translation</h2>
<p>In order to make the data information more understandable, it was translated some relevant labels and domains from Czech to English.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Translating relevant labels and domains to english --------------------------------------------</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3">disposition<span class="op">$</span>type &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(disposition<span class="op">$</span>type, <span class="kw">c</span>(<span class="st">&#39;OWNER&#39;</span>, <span class="st">&#39;DISPONENT&#39;</span>), </a>
<a class="sourceLine" id="cb8-4" title="4">                                    <span class="kw">c</span>(<span class="st">&#39;Owner&#39;</span>, <span class="st">&#39;User&#39;</span>))</a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6">account<span class="op">$</span>frequency &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(account<span class="op">$</span>frequency,</a>
<a class="sourceLine" id="cb8-7" title="7">                                     <span class="kw">c</span>(<span class="st">&#39;POPLATEK MESICNE&#39;</span>, <span class="st">&#39;POPLATEK TYDNE&#39;</span>, </a>
<a class="sourceLine" id="cb8-8" title="8">                                       <span class="st">&#39;POPLATEK PO OBRATU&#39;</span>),</a>
<a class="sourceLine" id="cb8-9" title="9">                                     <span class="kw">c</span>(<span class="st">&#39;Monthly&#39;</span>, <span class="st">&#39;Weekly&#39;</span>, <span class="st">&#39;On Transaction&#39;</span>))</a>
<a class="sourceLine" id="cb8-10" title="10"></a>
<a class="sourceLine" id="cb8-11" title="11">permanent_order<span class="op">$</span>k_symbol &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(permanent_order<span class="op">$</span>k_symbol,</a>
<a class="sourceLine" id="cb8-12" title="12">                                            <span class="kw">c</span>(<span class="st">&#39;POJISTNE&#39;</span>, <span class="st">&#39;SIPO&#39;</span>, <span class="st">&#39;LEASING&#39;</span>, <span class="st">&#39;UVER&#39;</span>),</a>
<a class="sourceLine" id="cb8-13" title="13">                                            <span class="kw">c</span>(<span class="st">&#39;insurrance payment&#39;</span>, <span class="st">&#39;household&#39;</span>, </a>
<a class="sourceLine" id="cb8-14" title="14">                                              <span class="st">&#39;leasing&#39;</span>, <span class="st">&#39;loan payment&#39;</span>))</a>
<a class="sourceLine" id="cb8-15" title="15"></a>
<a class="sourceLine" id="cb8-16" title="16">transaction<span class="op">$</span>type &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(transaction<span class="op">$</span>type,</a>
<a class="sourceLine" id="cb8-17" title="17">                                    <span class="kw">c</span>(<span class="st">&#39;PRIJEM&#39;</span>, <span class="st">&#39;VYDAJ&#39;</span>, <span class="st">&#39;VYBER&#39;</span>),</a>
<a class="sourceLine" id="cb8-18" title="18">                                    <span class="kw">c</span>(<span class="st">&#39;credit&#39;</span>, <span class="st">&#39;withdrawal&#39;</span>, <span class="st">&#39;withdrawal in cash&#39;</span>))</a>
<a class="sourceLine" id="cb8-19" title="19"></a>
<a class="sourceLine" id="cb8-20" title="20">transaction<span class="op">$</span>operation &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(transaction<span class="op">$</span>operation,</a>
<a class="sourceLine" id="cb8-21" title="21">                                         <span class="kw">c</span>(<span class="st">&#39;VYBER KARTOU&#39;</span>, <span class="st">&#39;VKLAD&#39;</span>, <span class="st">&#39;PREVOD Z UCTU&#39;</span>, </a>
<a class="sourceLine" id="cb8-22" title="22">                                           <span class="st">&#39;VYBER&#39;</span>, <span class="st">&#39;PREVOD NA UCET&#39;</span>),</a>
<a class="sourceLine" id="cb8-23" title="23">                                         <span class="kw">c</span>(<span class="st">&#39;credit card withdrawal&#39;</span>, <span class="st">&#39;credit in cash&#39;</span>, </a>
<a class="sourceLine" id="cb8-24" title="24">                                           <span class="st">&#39;collection from another bank&#39;</span>, </a>
<a class="sourceLine" id="cb8-25" title="25">                                           <span class="st">&#39;withdrawal in cash&#39;</span>, <span class="st">&#39;remittance to nother bank&#39;</span>))</a>
<a class="sourceLine" id="cb8-26" title="26"></a>
<a class="sourceLine" id="cb8-27" title="27">transaction<span class="op">$</span>k_symbol &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">mapvalues</span>(transaction<span class="op">$</span>k_symbol, </a>
<a class="sourceLine" id="cb8-28" title="28">                                        <span class="kw">c</span>(<span class="st">&#39;POJISTNE&#39;</span>, <span class="st">&#39;SLUZBY&#39;</span>, <span class="st">&#39;UROK&#39;</span>, <span class="st">&#39;SANKC. UROK&#39;</span>, </a>
<a class="sourceLine" id="cb8-29" title="29">                                          <span class="st">&#39;SIPO&#39;</span>, <span class="st">&#39;DUCHOD&#39;</span>, <span class="st">&#39;UVER&#39;</span>),</a>
<a class="sourceLine" id="cb8-30" title="30">                                        <span class="kw">c</span>(<span class="st">&#39;insurance payment&#39;</span>, <span class="st">&#39;statement&#39;</span>, </a>
<a class="sourceLine" id="cb8-31" title="31">                                          <span class="st">&#39;interest credited&#39;</span>, <span class="st">&#39;sanction interest&#39;</span>, </a>
<a class="sourceLine" id="cb8-32" title="32">                                          <span class="st">&#39;household&#39;</span>, <span class="st">&#39;old age pension&#39;</span>, <span class="st">&#39;loan payment&#39;</span>))</a></code></pre></div>
</div>
<div id="data-enhancement" class="section level2">
<h2><span class="header-section-number">2.5</span> Data Enhancement</h2>
<p>This step aims to improve the analysis by adding auxiliary information. Data enhancement is all about making sure any data that is coming into the business is being looked at with a critical eye and is being filtered down to maximize its value.</p>
<p>The code below get gender, birthday and age from birth_number column using <em>GetGenderFromBirthnumber</em> and <em>GetBirthdateFromBirthnumber</em> functions.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">client &lt;-<span class="st"> </span>client <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">GetGenderFromBirthnumber</span>(birth_number)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">birth_date =</span> <span class="kw">GetBirthdateFromBirthnumber</span>(birth_number, gender)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age =</span> <span class="kw">GetAgeFromBirthnumber</span>(birth_number))</a></code></pre></div>
<p>The code below improved loan data by having a classification regarding its payment status.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">loan &lt;-<span class="st"> </span><span class="kw">mutate</span>(loan, <span class="dt">defaulter =</span> </a>
<a class="sourceLine" id="cb10-2" title="2">                <span class="kw">as.logical</span>(plyr<span class="op">::</span><span class="kw">mapvalues</span>(status, <span class="kw">c</span> (<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>), </a>
<a class="sourceLine" id="cb10-3" title="3">                                           <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>))),</a>
<a class="sourceLine" id="cb10-4" title="4">                <span class="dt">contract_status =</span> plyr<span class="op">::</span><span class="kw">mapvalues</span>(status, <span class="kw">c</span> (<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>), </a>
<a class="sourceLine" id="cb10-5" title="5">                                 <span class="kw">c</span>(<span class="st">&#39;finished&#39;</span>,<span class="st">&#39;finished&#39;</span>,<span class="st">&#39;running&#39;</span>,<span class="st">&#39;running&#39;</span>)),</a>
<a class="sourceLine" id="cb10-6" title="6">                                 <span class="dt">type =</span> <span class="st">&#39;Owner&#39;</span>)</a></code></pre></div>
<p>The code below improved client data by having its age group.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">client &lt;-<span class="st"> </span><span class="kw">mutate</span>(client, <span class="dt">age_bin =</span> <span class="kw">paste</span>(<span class="kw">findInterval</span>(age, </a>
<a class="sourceLine" id="cb11-2" title="2">                 <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">10</span>,<span class="st">&#39;+&#39;</span>))</a></code></pre></div>
<p>The code below calculate an additional table with current and average account balance for each account.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">account_balance &lt;-<span class="st"> </span><span class="kw">arrange</span>(transaction, <span class="kw">desc</span>(date), account_id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(account_id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">avg_balance =</span> <span class="kw">mean</span>(balance)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(account_id, date, balance, avg_balance)</a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw">colnames</span>(account_balance) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;account_id&quot;</span>, <span class="st">&quot;last_transaction_date&quot;</span>, <span class="st">&#39;account_balance&#39;</span>, <span class="st">&#39;avg_balance&#39;</span>)</a></code></pre></div>
<p>The code below calculate an additional table with the proportion of each transaction type (k_symbol) on total transaction amount of each account. That data will be used to fit a logistic model on loan dataset.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">account_transaction_pattern &lt;-<span class="st"> </span><span class="kw">select</span>(transaction, <span class="kw">c</span>(trans_id, account_id, date, amount, k_symbol)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">k_symbol =</span> <span class="kw">ifelse</span>(k_symbol <span class="op">==</span><span class="st"> &#39;&#39;</span> <span class="op">|</span><span class="st"> </span><span class="kw">is.na</span>(k_symbol), <span class="st">&#39;other&#39;</span>, k_symbol)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> k_symbol, <span class="dt">value =</span> amount) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">    </span><span class="kw">replace</span>(<span class="kw">is.na</span>(.), <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">amount =</span> <span class="kw">rowSums</span>(.[<span class="dv">4</span><span class="op">:</span><span class="dv">11</span>])) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">    </span><span class="kw">group_by</span>(account_id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">transaction_count =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb13-8" title="8">              <span class="dt">last_transaction_date =</span> <span class="kw">max</span>(date),</a>
<a class="sourceLine" id="cb13-9" title="9">              <span class="dt">amount =</span> <span class="kw">sum</span>(amount),</a>
<a class="sourceLine" id="cb13-10" title="10">              <span class="dt">prop_household =</span> <span class="kw">sum</span>(household) <span class="op">/</span><span class="st"> </span>amount,</a>
<a class="sourceLine" id="cb13-11" title="11">              <span class="dt">prop_insurance_payment =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">insurance payment</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>amount,</a>
<a class="sourceLine" id="cb13-12" title="12">              <span class="dt">prop_interest_credited =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">interest credited</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>amount,</a>
<a class="sourceLine" id="cb13-13" title="13">              <span class="dt">prop_loan_payment =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">loan payment</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>amount,</a>
<a class="sourceLine" id="cb13-14" title="14">              <span class="dt">prop_old_age_pension =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">old age pension</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>amount,</a>
<a class="sourceLine" id="cb13-15" title="15">              <span class="dt">prop_other =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">other</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>amount,</a>
<a class="sourceLine" id="cb13-16" title="16">              <span class="dt">prop_sanction_interest =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">sanction interest</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>amount,</a>
<a class="sourceLine" id="cb13-17" title="17">              <span class="dt">prop_statement =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">statement</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>amount)</a></code></pre></div>
<hr />
</div>
</div>
<div id="the-explorations" class="section level1">
<h1><span class="header-section-number">3</span> The explorations</h1>
<div id="gender-exploration" class="section level2">
<h2><span class="header-section-number">3.1</span> Gender Exploration</h2>
<p>At first glance, gender equality is well balanced in the bank, even when observed over the decades. Even more impressive, gender equality is everywhere in the country.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># gender distribution of clients in the bank</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> client) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> gender, <span class="dt">fill =</span> gender) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Gender distribution of clients in the bank&quot;</span>,</a>
<a class="sourceLine" id="cb14-6" title="6">       <span class="dt">subtitle =</span> <span class="st">&quot;A well balanced bank&quot;</span>,</a>
<a class="sourceLine" id="cb14-7" title="7">       <span class="dt">x =</span> <span class="st">&quot;Gender&quot;</span>,</a>
<a class="sourceLine" id="cb14-8" title="8">       <span class="dt">y =</span> <span class="st">&quot;Total clients&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="st">  </span><span class="kw">theme_economist</span>()</a></code></pre></div>
<p><img src="01_exploration_report_files/figure-html/gender_distribution_analysis-1.png" width="100%" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">clientGenderOverDecades &lt;-<span class="st"> </span>client <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(<span class="dt">decade =</span> <span class="kw">as.integer</span>(<span class="kw">substr</span>(client<span class="op">$</span>birth_number, <span class="dv">1</span>,<span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, </a>
<a class="sourceLine" id="cb15-3" title="3">           <span class="dt">gender =</span> client<span class="op">$</span>gender) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">  </span><span class="kw">count</span>()</a>
<a class="sourceLine" id="cb15-5" title="5"></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co"># gender distribution of clients in the bank over the decades</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="kw">ggplot</span>(<span class="dt">data =</span> clientGenderOverDecades) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> decade, <span class="dt">fill =</span> gender, <span class="dt">weight =</span> n) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> n, <span class="dt">color =</span> gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Gender distribution of clients in the bank over the decades&quot;</span>,</a>
<a class="sourceLine" id="cb15-13" title="13">       <span class="dt">subtitle =</span> <span class="st">&quot;Equality at its finest&quot;</span>,</a>
<a class="sourceLine" id="cb15-14" title="14">       <span class="dt">x =</span> <span class="st">&quot;Decades&quot;</span>,</a>
<a class="sourceLine" id="cb15-15" title="15">       <span class="dt">y =</span> <span class="st">&quot;Total clients&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="st">  </span><span class="kw">theme_economist</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(gender))</a></code></pre></div>
<p><img src="01_exploration_report_files/figure-html/gender_distribution_analysis-2.png" width="100%" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># alluvial diagram representation of gender, age group and region</span></a>
<a class="sourceLine" id="cb16-2" title="2">clientGenderAgeGroupByRegion &lt;-<span class="st"> </span>client <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_group =</span> <span class="kw">ifelse</span>(age <span class="op">&lt;</span><span class="st"> </span><span class="dv">21</span>, <span class="st">&quot;young&quot;</span>, </a>
<a class="sourceLine" id="cb16-4" title="4">                     <span class="kw">ifelse</span>(age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">21</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">60</span>, <span class="st">&quot;adult&quot;</span>, <span class="st">&quot;senior&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">  </span><span class="kw">inner_join</span>(district, <span class="dt">by =</span> <span class="st">&quot;district_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(age_group, gender, region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="st">  </span><span class="kw">count</span>()</a>
<a class="sourceLine" id="cb16-8" title="8">  </a>
<a class="sourceLine" id="cb16-9" title="9"><span class="kw">ggplot</span>(<span class="dt">data =</span> clientGenderAgeGroupByRegion, </a>
<a class="sourceLine" id="cb16-10" title="10">       <span class="kw">aes</span>(<span class="dt">axis1 =</span> region, <span class="dt">axis2 =</span> age_group, <span class="dt">y =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;region&quot;</span>, <span class="st">&quot;age group&quot;</span>), <span class="dt">expand =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Demographic&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="st">  </span><span class="kw">geom_alluvium</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> gender), <span class="dt">knot.pos =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="st">  </span><span class="kw">geom_stratum</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">stat =</span> <span class="st">&quot;stratum&quot;</span>, <span class="dt">label.strata =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="st">  </span><span class="kw">theme_economist</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Region and age group by gender&quot;</span>, <span class="st">&quot;Equality is everywhere&quot;</span>) </a></code></pre></div>
<p><img src="01_exploration_report_files/figure-html/gender_distribution_analysis-3.png" width="100%" /></p>
</div>
<div id="loan-exploration" class="section level2">
<h2><span class="header-section-number">3.2</span> Loan Exploration</h2>
<p>Here we investigate if there is any association between the region and the likelihood of default in the 682 loan observations in the dataset.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">left_join</span>(loan, disposition, <span class="dt">by =</span> <span class="st">&#39;account_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(client, <span class="dt">by =</span> <span class="st">&#39;client_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(district, <span class="dt">by =</span> <span class="st">&#39;district_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(region, contract_status, defaulter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb17-6" title="6">            <span class="dt">amount =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="st">  </span><span class="kw">group_by</span>(region, contract_status) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_contract_status =</span> <span class="kw">sum</span>(count),</a>
<a class="sourceLine" id="cb17-9" title="9">         <span class="dt">amount_contract_status =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_region =</span> <span class="kw">sum</span>(count),</a>
<a class="sourceLine" id="cb17-12" title="12">         <span class="dt">amount_region =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> defaulter, <span class="dt">y =</span> contract_status, <span class="dt">fill =</span> count <span class="op">/</span><span class="st"> </span>count_region)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="st">  </span><span class="kw">geom_bin2d</span>(<span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">round</span>(count <span class="op">/</span><span class="st"> </span>count_region <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>), <span class="st">&#39;%&#39;</span>)), </a>
<a class="sourceLine" id="cb17-16" title="16">            <span class="dt">color =</span> <span class="st">&#39;white&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>region) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="st">  </span><span class="kw">theme_economist</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>, <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb17-20" title="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Defaulter&#39;</span>, </a>
<a class="sourceLine" id="cb17-22" title="22">       <span class="dt">y =</span> <span class="st">&#39;Contract Status&#39;</span>, </a>
<a class="sourceLine" id="cb17-23" title="23">       <span class="dt">title =</span> <span class="st">&#39;Loan Contract Status by Region Heatmap&#39;</span>)</a></code></pre></div>
<p><img src="01_exploration_report_files/figure-html/Loan_status_by_region-1.png" width="100%" /></p>
<p>We perform the same investigation on the association between the client gender and the likelihood of default in the 682 loan observations in the dataset.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">left_join</span>(loan, disposition, <span class="dt">by =</span> <span class="st">&#39;account_id&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(client, <span class="dt">by =</span> <span class="st">&#39;client_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(district, <span class="dt">by =</span> <span class="st">&#39;district_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(gender, contract_status, defaulter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb18-6" title="6">            <span class="dt">amount =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">  </span><span class="kw">group_by</span>(gender, contract_status) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_contract_status =</span> <span class="kw">sum</span>(count),</a>
<a class="sourceLine" id="cb18-9" title="9">         <span class="dt">amount_contract_status =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_gender =</span> <span class="kw">sum</span>(count),</a>
<a class="sourceLine" id="cb18-12" title="12">         <span class="dt">amount_gender =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> defaulter, <span class="dt">y =</span> contract_status, </a>
<a class="sourceLine" id="cb18-14" title="14">             <span class="dt">fill =</span> count <span class="op">/</span><span class="st"> </span>count_gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="st">    </span><span class="kw">geom_bin2d</span>(<span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">round</span>(count <span class="op">/</span><span class="st"> </span>count_gender <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>), <span class="st">&#39;%&#39;</span>)), </a>
<a class="sourceLine" id="cb18-17" title="17">              <span class="dt">color =</span> <span class="st">&#39;white&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>gender) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="st">    </span><span class="kw">theme_economist</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>, <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb18-21" title="21">          <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Defaulter&#39;</span>,</a>
<a class="sourceLine" id="cb18-23" title="23">         <span class="dt">y =</span> <span class="st">&#39;Contract Status&#39;</span>,</a>
<a class="sourceLine" id="cb18-24" title="24">         <span class="dt">title =</span> <span class="st">&#39;Loan Contract Status by Gender Heatmap&#39;</span>)</a></code></pre></div>
<p><img src="01_exploration_report_files/figure-html/Loan_status_by_gender-1.png" width="100%" /></p>
<p>We finnaly do the same investigation on the association between the client age and the likelihood of default in the 682 loan observations in the dataset.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">left_join</span>(loan, disposition, <span class="dt">by =</span> <span class="st">&#39;account_id&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(client, <span class="dt">by =</span> <span class="st">&#39;client_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(district, <span class="dt">by =</span> <span class="st">&#39;district_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(age_bin, contract_status, defaulter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb19-6" title="6">            <span class="dt">amount =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="st">  </span><span class="kw">group_by</span>(age_bin, contract_status) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_contract_status =</span> <span class="kw">sum</span>(count),</a>
<a class="sourceLine" id="cb19-9" title="9">         <span class="dt">amount_contract_status =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(age_bin) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_age_bin =</span> <span class="kw">sum</span>(count),</a>
<a class="sourceLine" id="cb19-12" title="12">         <span class="dt">amount_age_bin =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> defaulter, </a>
<a class="sourceLine" id="cb19-14" title="14">             <span class="dt">y =</span> contract_status, <span class="dt">fill =</span> count <span class="op">/</span><span class="st"> </span>count_age_bin)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="st">    </span><span class="kw">geom_bin2d</span>(<span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">round</span>(count <span class="op">/</span><span class="st"> </span>count_age_bin <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>), <span class="st">&#39;%&#39;</span>)), </a>
<a class="sourceLine" id="cb19-17" title="17">              <span class="dt">color =</span> <span class="st">&#39;white&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>age_bin) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="st">    </span><span class="kw">theme_economist</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-20" title="20"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>, <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb19-21" title="21">          <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Defaulter&#39;</span>,</a>
<a class="sourceLine" id="cb19-23" title="23">         <span class="dt">y =</span> <span class="st">&#39;Contract Status&#39;</span>,</a>
<a class="sourceLine" id="cb19-24" title="24">         <span class="dt">title =</span> <span class="st">&#39;Loan Contract Status by Age Group Heatmap&#39;</span>)</a></code></pre></div>
<p><img src="01_exploration_report_files/figure-html/Loan_status_by_age_bin-1.png" width="100%" /></p>
<p>It seems that none of these features, alone, are determinant on the odds of a client default.</p>
</div>
<div id="account-balance-exploration" class="section level2">
<h2><span class="header-section-number">3.3</span> Account Balance Exploration</h2>
<p>As we do not have the individual income of each client, we tried to perform a proxy of the client’s wealth by calculating the average account balance of each account and investigating the distribution by region and age.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">left_join</span>(account_balance, disposition, <span class="dt">by =</span> <span class="st">&#39;account_id&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(client, <span class="dt">by =</span> <span class="st">&#39;client_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(district, <span class="dt">by =</span> <span class="st">&#39;district_id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &#39;Owner&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(avg_balance <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="kw">aes</span>(<span class="dt">fill =</span> gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Average Account Balance Distribution by Gender and Region&#39;</span>,</a>
<a class="sourceLine" id="cb20-9" title="9">         <span class="dt">subtitle =</span> <span class="st">&#39;k (Kč) - Koruna (CZK)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="st">    </span><span class="kw">theme_economist</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>region)</a></code></pre></div>
<p><img src="01_exploration_report_files/figure-html/avg_account_balance_by_gender_and_region-1.png" width="100%" /></p>
<p>One interest pattern shows up, males in prague region tend to have a bigger average account balance them females, and the oposite trend in South, North and West Bohemia.</p>
</div>
<div id="district-exploration" class="section level2">
<h2><span class="header-section-number">3.4</span> District exploration</h2>
<p>Regarding the Czech regions, we can notice in the exploration below which regions are more likely to have defaulters based on the finished loans operations so far.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">loan_amount_by_region &lt;-<span class="st"> </span><span class="kw">select</span>(loan, account_id, amount, defaulter, contract_status) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span><span class="kw">filter</span>(defaulter <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="st">  </span><span class="kw">inner_join</span>(account) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span><span class="kw">inner_join</span>(district) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">transaction_count =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb21-7" title="7">            <span class="dt">amount =</span> <span class="kw">sum</span>(amount)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="st">  </span><span class="kw">inner_join</span>(czech_regions_coords)</a>
<a class="sourceLine" id="cb21-9" title="9"></a>
<a class="sourceLine" id="cb21-10" title="10">jsonMapFile &lt;-<span class="st"> &quot;./map/czech-republic-regions.json&quot;</span></a>
<a class="sourceLine" id="cb21-11" title="11">czech_regions &lt;-<span class="st"> </span><span class="kw">as.json</span>(<span class="kw">geojson_read</span>(jsonMapFile))</a>
<a class="sourceLine" id="cb21-12" title="12"></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="kw">leaflet</span>(loan_amount_by_region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-14" title="14"><span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="st">  </span><span class="kw">setView</span>(<span class="dt">lng =</span> <span class="fl">15.3</span>, <span class="dt">lat =</span> <span class="fl">49.8</span>, <span class="dt">zoom =</span> <span class="dv">7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="st">  </span><span class="kw">addGeoJSON</span>(czech_regions, <span class="dt">fillColor =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">stroke =</span> <span class="st">&quot;#555555&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-17" title="17"><span class="st">  </span><span class="kw">addCircles</span>(<span class="dt">lng =</span> <span class="op">~</span>long,   </a>
<a class="sourceLine" id="cb21-18" title="18">             <span class="dt">lat =</span> <span class="op">~</span>lat,    </a>
<a class="sourceLine" id="cb21-19" title="19">             <span class="dt">weight =</span> <span class="dv">2</span>,    </a>
<a class="sourceLine" id="cb21-20" title="20">             <span class="dt">radius =</span> <span class="op">~</span><span class="kw">sqrt</span>(amount) <span class="op">*</span><span class="st"> </span><span class="dv">30</span>,   </a>
<a class="sourceLine" id="cb21-21" title="21">             <span class="dt">popup =</span> <span class="op">~</span>region)</a></code></pre></div>
<div id="htmlwidget-be3addfb01dc89f6ba0d" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-be3addfb01dc89f6ba0d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addGeoJSON","args":[{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":1,"NAME_1":"Ústecký","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Aussig an der Elbe|Aussig|Ústí nad Labem"},"geometry":{"type":"Polygon","coordinates":[[[14.6415965,50.8478083],[14.5744002,50.8158994],[14.5467312,50.7812666],[14.5157682,50.7816557],[14.4650416,50.8011124],[14.4518658,50.7843797],[14.4531834,50.7610317],[14.4314434,50.7392403],[14.4380313,50.7213402],[14.3892811,50.7073314],[14.3787405,50.6645268],[14.3484363,50.6427354],[14.3721526,50.6014873],[14.4406665,50.5131542],[14.4683355,50.4975889],[14.4801937,50.4719061],[14.4722882,50.4454451],[14.4459368,50.4419429],[14.4116798,50.4228754],[14.3714938,50.4189841],[14.3793993,50.3648946],[14.3609532,50.3469945],[14.2818988,50.3458271],[14.2568648,50.3275379],[14.2002092,50.3388227],[14.1619995,50.3252031],[14.117202,50.3248139],[14.0605463,50.3399901],[14.0131136,50.3403792],[13.9986203,50.3271487],[14.0071845,50.3026334],[13.9683161,50.2948507],[13.9525052,50.2757832],[13.8833325,50.2621636],[13.8774035,50.2360917],[13.8194302,50.2493222],[13.767386,50.2306438],[13.7555278,50.2150785],[13.6712031,50.2181916],[13.6152062,50.1855044],[13.553939,50.1777218],[13.510459,50.1524281],[13.4972833,50.1279128],[13.4623676,50.0998952],[13.4228403,50.0847191],[13.3905598,50.0738233],[13.3694786,50.0870538],[13.3095289,50.10223],[13.3009647,50.1142931],[13.2574848,50.1224649],[13.2693429,50.1419216],[13.2910829,50.1419216],[13.3035999,50.1644913],[13.266049,50.1979567],[13.2673666,50.2279199],[13.2482617,50.2333678],[13.2515557,50.2563266],[13.2383799,50.2761723],[13.2403563,50.3061356],[13.2561672,50.32209],[13.225863,50.3504967],[13.1349504,50.3462162],[13.0908116,50.3769577],[13.0038517,50.3901882],[12.9860645,50.4193732],[12.9952875,50.4337711],[13.0282268,50.4493364],[13.0242741,50.4761866],[13.0334971,50.5084846],[13.0914704,50.4987563],[13.1336328,50.5150998],[13.1435146,50.5061498],[13.1962176,50.5007019],[13.1968763,50.515489],[13.2265218,50.5392261],[13.2357448,50.5777502],[13.2489205,50.5921481],[13.284495,50.5793067],[13.3266574,50.5816415],[13.3240223,50.6022656],[13.3767252,50.6271701],[13.4090058,50.6318397],[13.4136173,50.6131613],[13.4656615,50.6038221],[13.5025536,50.6287266],[13.5262699,50.635731],[13.5144117,50.6567441],[13.541422,50.6676399],[13.5486687,50.7131684],[13.6198177,50.7131684],[13.652757,50.7330142],[13.6903079,50.7170597],[13.7239061,50.7260098],[13.7930787,50.7275663],[13.8214065,50.7155032],[13.8569811,50.7217293],[13.8951907,50.7836014],[13.9360355,50.7820449],[13.9485525,50.8003341],[13.984127,50.8100624],[14.0236542,50.794108],[14.0414415,50.8046146],[14.1178608,50.8244603],[14.1415771,50.8345778],[14.1942801,50.8404148],[14.2179964,50.8509214],[14.2252431,50.876215],[14.2542297,50.8863324],[14.2950745,50.8746585],[14.3365781,50.8890564],[14.3721526,50.8886672],[14.3912574,50.9057891],[14.4011392,50.9423676],[14.3576593,50.9447024],[14.2581824,50.9727199],[14.2535709,50.9945113],[14.2627939,51.0163028],[14.2832163,51.0264202],[14.3517302,51.0303116],[14.3675411,51.0151354],[14.4097035,51.0085201],[14.4485719,51.0307007],[14.5335554,51.0143571],[14.5948226,50.9886744],[14.5974578,50.9703851],[14.565836,50.9365306],[14.5678124,50.9194087],[14.6033869,50.9209653],[14.6297384,50.9361414],[14.6541135,50.9147391],[14.6264444,50.8987847],[14.6066808,50.8622062],[14.6415965,50.8478083]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":2,"NAME_1":"Jihočeský","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Budweis|Budejovický|Ceskobudejovický|South Bohemian"},"geometry":{"type":"Polygon","coordinates":[[[14.9413447,49.5434354],[14.9472738,49.5115266],[14.9235574,49.4963504],[14.9308041,49.457048],[14.9077465,49.4122977],[14.9070878,49.3578191],[14.9228986,49.3360277],[14.9169696,49.3177385],[14.9578144,49.2885535],[14.9769192,49.2624816],[15.0309397,49.2698751],[15.1080178,49.2469163],[15.1067003,49.2247358],[15.1350281,49.2270706],[15.1534741,49.2060574],[15.1745553,49.2009987],[15.2160589,49.2130618],[15.333323,49.219677],[15.3570394,49.1986639],[15.3497927,49.1745376],[15.416989,49.1360135],[15.4861616,49.1247286],[15.5586282,49.1356244],[15.6007906,49.0803675],[15.5645573,49.0756979],[15.5342531,49.0270563],[15.506584,49.0029301],[15.5546755,48.9768582],[15.5830034,48.967519],[15.5915676,48.9511755],[15.5362295,48.9091491],[15.5072428,48.9122622],[15.4980198,48.9391123],[15.4492696,48.9503972],[15.4216005,48.9492298],[15.364286,48.9826952],[15.3063128,48.9815278],[15.293137,48.9935909],[15.2628328,48.9570124],[15.2226468,48.9624603],[15.1923426,48.9472841],[15.169285,48.9511755],[15.1580856,48.9959257],[15.1389808,49.0002062],[15.0691494,48.9963149],[15.0539973,49.0126584],[14.9993179,49.0107128],[14.9795543,48.9589581],[14.9953652,48.902923],[14.9749428,48.8741272],[14.9808719,48.8519466],[14.9584731,48.8153681],[14.9624259,48.7896854],[14.9802131,48.7737309],[14.9617671,48.7605004],[14.8800775,48.7830701],[14.810246,48.7799571],[14.8148576,48.7682831],[14.7786243,48.7149719],[14.7358031,48.7013523],[14.7120868,48.6554346],[14.7199922,48.6422041],[14.7193334,48.6044582],[14.7028637,48.5865581],[14.6633365,48.5850016],[14.6435729,48.6110735],[14.6244681,48.6071821],[14.6027281,48.6297518],[14.5526603,48.6079604],[14.4960046,48.6320866],[14.4696531,48.6495976],[14.4512071,48.6316975],[14.4426428,48.6064039],[14.4255144,48.5916168],[14.3892811,48.5939516],[14.3873047,48.5717711],[14.3602944,48.577608],[14.3484363,48.5562057],[14.2865103,48.5663232],[14.2706994,48.583445],[14.2371012,48.5814994],[14.1942801,48.5974538],[14.1534353,48.5993995],[14.1000735,48.5939516],[14.0434178,48.6130191],[14.0407827,48.6336432],[14.0572523,48.6760586],[14.0203603,48.6869543],[13.9986203,48.7091349],[13.9347179,48.7223654],[13.9110016,48.7484373],[13.8668629,48.7729527],[13.8121835,48.7756766],[13.8102072,48.8017485],[13.7627745,48.8391052],[13.7515751,48.8745163],[13.7324703,48.8815207],[13.6712031,48.8830772],[13.652757,48.8955295],[13.625088,48.9395015],[13.5980777,48.9476733],[13.5835844,48.9682973],[13.5545978,49.0021518],[13.5710674,49.0360064],[13.6185001,49.0558522],[13.6204765,49.0690827],[13.5980777,49.1002133],[13.6046656,49.1418505],[13.6507807,49.1399048],[13.7094127,49.169868],[13.7311527,49.1982747],[13.7133655,49.2274597],[13.736423,49.2582012],[13.7232473,49.2764904],[13.7436697,49.2877753],[13.7482812,49.3122906],[13.7779266,49.3274668],[13.8042781,49.3679366],[13.7733151,49.4076281],[13.7970314,49.4352566],[13.7884672,49.462885],[13.7647509,49.4916808],[13.7930787,49.5095809],[13.8839913,49.5239788],[13.9366943,49.5045222],[13.9854445,49.5130831],[14.0262893,49.5473268],[14.0585699,49.556666],[14.0961208,49.5340963],[14.1310365,49.5325397],[14.2074558,49.5379876],[14.2403952,49.5609464],[14.2944157,49.565616],[14.3497538,49.5360419],[14.3859871,49.5352637],[14.4353962,49.5535529],[14.4768997,49.5372093],[14.5151094,49.5453811],[14.5500251,49.5352637],[14.5921875,49.5387659],[14.6574074,49.5138614],[14.7074752,49.5446028],[14.7377795,49.5543312],[14.7331679,49.5850726],[14.7470025,49.6045293],[14.7753303,49.6162033],[14.8306684,49.5963575],[14.8675605,49.5983032],[14.8827126,49.5745661],[14.9413447,49.5434354]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":3,"NAME_1":"Jihomoravský","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Brünn|Jihomoravský Brnenský|South Moravian"},"geometry":{"type":"Polygon","coordinates":[[[16.791219,49.6080315],[16.8090062,49.5854618],[16.7675026,49.5683399],[16.7595972,49.5430463],[16.8103238,49.5313723],[16.8063711,49.4768938],[16.8267935,49.4480979],[16.8208644,49.4060716],[16.8564389,49.3881715],[16.893331,49.3967324],[16.9190237,49.4352566],[16.890037,49.4547132],[16.8781789,49.4753372],[16.8953073,49.4916808],[16.9585509,49.4916808],[16.9769969,49.4800068],[16.9895139,49.451211],[17.0455108,49.4006237],[17.0804265,49.3920628],[17.0646156,49.3722171],[17.0797677,49.3570409],[17.1278592,49.3434212],[17.1963731,49.2940014],[17.1588222,49.2585903],[17.1858325,49.1764833],[17.2227245,49.1788181],[17.2286536,49.1480766],[17.1897852,49.1321222],[17.1858325,49.1138329],[17.1482816,49.1025481],[17.1489404,49.0745305],[17.2069136,49.0702501],[17.2378766,49.0760871],[17.2543463,49.0422325],[17.3123196,49.0309477],[17.3281305,49.0223867],[17.3656813,49.0266672],[17.3926916,49.0138258],[17.4071849,48.9943692],[17.4539588,48.9896996],[17.4644994,48.9632386],[17.4895333,48.9356101],[17.5237903,48.9538994],[17.5659526,48.9535103],[17.6127265,48.926271],[17.6911222,48.8698467],[17.6865107,48.8601184],[17.6094326,48.8542814],[17.5811047,48.83249],[17.515226,48.8095311],[17.47504,48.8394944],[17.4467122,48.8453314],[17.4098201,48.829766],[17.3630462,48.8285986],[17.2741099,48.8651771],[17.199667,48.8811316],[17.146964,48.8496118],[17.1133659,48.8398835],[17.0929435,48.7963006],[17.0474872,48.7745092],[17.0165242,48.7429895],[17.0013721,48.700574],[16.9723854,48.6869543],[16.9605273,48.6445389],[16.9223176,48.6211909],[16.9177061,48.7025197],[16.8801552,48.7254785],[16.8630268,48.7099132],[16.7978068,48.709524],[16.7576208,48.7184741],[16.7451039,48.7344285],[16.7187524,48.7394873],[16.6838367,48.7305372],[16.6759312,48.7671157],[16.6541912,48.7799571],[16.6074174,48.7741201],[16.5369271,48.803305],[16.5244102,48.7935767],[16.4499672,48.7912419],[16.4381091,48.7682831],[16.4058285,48.7398764],[16.3663013,48.7250893],[16.2977874,48.7359851],[16.2233444,48.7332611],[16.1956754,48.7414329],[16.1073979,48.7379307],[16.0448131,48.7538852],[16.0092386,48.7795679],[15.9459951,48.8040833],[15.9262315,48.8348248],[15.8755048,48.8570053],[15.803697,48.873738],[15.7766868,48.8741272],[15.7529704,48.8562271],[15.6870917,48.8601184],[15.6574463,48.8826881],[15.6192366,48.8978643],[15.5559931,48.9009773],[15.5362295,48.9091491],[15.5915676,48.9511755],[15.6310948,48.9383341],[15.6805038,48.9461167],[15.7608759,48.9511755],[15.7793219,48.9741343],[15.8484946,49.0017627],[15.8939509,49.0052649],[15.9519241,49.0461238],[16.0033095,49.029002],[16.0487659,49.0266672],[16.0685295,49.034839],[16.1027864,49.0293911],[16.1587833,49.0352281],[16.1772294,49.0628565],[16.2187329,49.0585761],[16.2424493,49.0648022],[16.2562838,49.0873719],[16.2846117,49.1037155],[16.2839529,49.1231721],[16.2576014,49.131733],[16.2622129,49.1636419],[16.2793414,49.1722028],[16.2760474,49.1982747],[16.2477196,49.231351],[16.3004225,49.2562555],[16.2885644,49.2897209],[16.3386322,49.3317473],[16.3755243,49.3406973],[16.3952879,49.3768866],[16.3873824,49.3947868],[16.3840885,49.4765046],[16.3728891,49.4959613],[16.41044,49.5154179],[16.41044,49.5344854],[16.3715716,49.5547203],[16.3939703,49.5784574],[16.4203218,49.5959684],[16.4842242,49.6025836],[16.5059641,49.5932444],[16.5375859,49.5990814],[16.5474677,49.6239859],[16.5725016,49.6337142],[16.6910833,49.6290446],[16.7615735,49.6091989],[16.791219,49.6080315]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":4,"NAME_1":"Karlovarský","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Carlsbad| Karlovy Vary"},"geometry":{"type":"Polygon","coordinates":[[[12.9860645,50.4193732],[13.0038517,50.3901882],[13.0908116,50.3769577],[13.1349504,50.3462162],[13.225863,50.3504967],[13.2561672,50.32209],[13.2403563,50.3061356],[13.2383799,50.2761723],[13.2515557,50.2563266],[13.2482617,50.2333678],[13.2673666,50.2279199],[13.266049,50.1979567],[13.3035999,50.1644913],[13.2910829,50.1419216],[13.2693429,50.1419216],[13.2574848,50.1224649],[13.3009647,50.1142931],[13.3095289,50.10223],[13.2943768,50.0567015],[13.2298157,50.0181774],[13.2364036,49.9921055],[13.2060994,49.9792641],[13.1764539,49.9987207],[13.1323152,50.0154534],[13.0881765,50.0146752],[13.0499668,49.9847119],[13.0157099,49.9683684],[12.9682772,49.9590292],[12.9557603,49.9275094],[12.9313851,49.9135007],[12.8154386,49.9228398],[12.7423132,49.9220616],[12.6731406,49.8905418],[12.6481067,49.9026049],[12.6019916,49.8956006],[12.5512649,49.9049397],[12.547971,49.9271203],[12.5123965,49.929066],[12.4755044,49.9399617],[12.4972444,49.976151],[12.4682578,49.9959968],[12.3760276,50.0166208],[12.3259597,50.0423036],[12.3160779,50.0598146],[12.2561283,50.0621494],[12.272598,50.0781038],[12.2613986,50.0921126],[12.1988138,50.1119583],[12.1935435,50.146202],[12.2100132,50.1730522],[12.1988138,50.1956219],[12.1625805,50.2178024],[12.1606042,50.2298656],[12.1019721,50.2434852],[12.0973606,50.2668332],[12.1256885,50.2742267],[12.1309588,50.3181987],[12.1942023,50.3228683],[12.1948611,50.2792854],[12.2528344,50.2757832],[12.2343883,50.2532135],[12.2732568,50.2349243],[12.2824798,50.1827805],[12.322007,50.1835588],[12.3397943,50.2111872],[12.3351828,50.2380373],[12.356264,50.2395939],[12.3588991,50.2668332],[12.3766864,50.2862898],[12.4096257,50.2979638],[12.4063318,50.3201443],[12.4471766,50.327927],[12.458376,50.3466054],[12.4932917,50.3493293],[12.4919741,50.3824056],[12.5163492,50.3999166],[12.6428364,50.4108123],[12.6665527,50.4178167],[12.7060799,50.4088666],[12.761418,50.4403864],[12.8009453,50.4403864],[12.8437664,50.4551734],[12.9359966,50.4069209],[12.9860645,50.4193732]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":5,"NAME_1":"Královéhradecký","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Königsgrätz| Hradec Králové"},"geometry":{"type":"Polygon","coordinates":[[[16.583701,50.148926],[16.5171635,50.1477586],[16.463143,50.1598217],[16.450626,50.1411433],[16.3445613,50.1041757],[16.3320443,50.0808277],[16.3037165,50.0613711],[16.3023989,50.0368557],[16.2734123,50.0341318],[16.2207093,50.0477514],[16.1693239,50.0407471],[16.1449488,50.0458058],[16.1120094,50.0664298],[16.0685295,50.0827734],[16.0336138,50.1065105],[15.9947453,50.1068996],[15.9795932,50.1380302],[15.9598296,50.1539847],[15.8952685,50.1652695],[15.8669406,50.1407542],[15.7931564,50.1333606],[15.7845922,50.1609891],[15.735842,50.1594325],[15.7114668,50.1279128],[15.6686457,50.1216867],[15.6383415,50.1279128],[15.5876149,50.1271345],[15.5559931,50.137252],[15.5118543,50.1240215],[15.5046077,50.1096235],[15.4677156,50.0960039],[15.4380702,50.1057322],[15.4360938,50.1251889],[15.3728503,50.1450346],[15.373509,50.1656587],[15.3926139,50.1788892],[15.3959078,50.2080741],[15.3807557,50.228309],[15.3847084,50.2563266],[15.3761442,50.2862898],[15.3478163,50.2967964],[15.3082891,50.2862898],[15.2200116,50.2936833],[15.2074947,50.327927],[15.1547917,50.3403792],[15.1244875,50.3691751],[15.1251463,50.3847404],[15.1567681,50.4147036],[15.141616,50.4512821],[15.1389808,50.4816344],[15.1159233,50.4968106],[15.1396396,50.5205477],[15.1686262,50.5022585],[15.2074947,50.4898062],[15.2483395,50.512765],[15.3563806,50.4886388],[15.3886611,50.477354],[15.416989,50.4851366],[15.4202829,50.5049824],[15.4558574,50.5326108],[15.4769386,50.5322217],[15.4894556,50.509652],[15.5276652,50.5080954],[15.5915676,50.5178238],[15.5968379,50.5318325],[15.5494052,50.574248],[15.5704864,50.6139395],[15.5480876,50.629894],[15.5296416,50.7123901],[15.5368883,50.7349598],[15.4874792,50.7906058],[15.5217361,50.7785427],[15.5928852,50.7816557],[15.6297772,50.764923],[15.6798451,50.7579187],[15.6890681,50.7404077],[15.7878862,50.744299],[15.8228019,50.750136],[15.8247782,50.7279554],[15.8550824,50.7065531],[15.8577176,50.6750334],[15.9209612,50.6820378],[15.9341369,50.691377],[15.9762993,50.6929335],[16.0006744,50.662192],[15.9980392,50.6081026],[16.0612828,50.6151069],[16.0593065,50.633007],[16.0922458,50.6614137],[16.1278203,50.6625811],[16.1798645,50.6283375],[16.2220269,50.638844],[16.2332263,50.6707529],[16.2615541,50.6719203],[16.2905407,50.6594681],[16.3327031,50.6653051],[16.3775006,50.6396223],[16.3933115,50.6178309],[16.4446969,50.5878677],[16.4460145,50.574248],[16.4110988,50.5688002],[16.3933115,50.5228825],[16.3603722,50.4991454],[16.3320443,50.4983671],[16.2701183,50.4828018],[16.2022633,50.4485581],[16.2128039,50.4084775],[16.2477196,50.4096449],[16.2714359,50.3742338],[16.348514,50.3816273],[16.3636661,50.3683968],[16.3656425,50.3415466],[16.3880412,50.3244248],[16.4374503,50.3213117],[16.4677545,50.2952399],[16.4684133,50.2820093],[16.512552,50.260607],[16.5211162,50.2384265],[16.5566907,50.2259742],[16.5613023,50.1629347],[16.583701,50.148926]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":6,"NAME_1":"Kraj Vysočina","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Iglau|Jihlavský|Vysocina|Vysočina"},"geometry":{"type":"Polygon","coordinates":[[[16.3939703,49.5784574],[16.3715716,49.5547203],[16.41044,49.5344854],[16.41044,49.5154179],[16.3728891,49.4959613],[16.3840885,49.4765046],[16.3873824,49.3947868],[16.3952879,49.3768866],[16.3755243,49.3406973],[16.3386322,49.3317473],[16.2885644,49.2897209],[16.3004225,49.2562555],[16.2477196,49.231351],[16.2760474,49.1982747],[16.2793414,49.1722028],[16.2622129,49.1636419],[16.2576014,49.131733],[16.2839529,49.1231721],[16.2846117,49.1037155],[16.2562838,49.0873719],[16.2424493,49.0648022],[16.2187329,49.0585761],[16.1772294,49.0628565],[16.1587833,49.0352281],[16.1027864,49.0293911],[16.0685295,49.034839],[16.0487659,49.0266672],[16.0033095,49.029002],[15.9519241,49.0461238],[15.8939509,49.0052649],[15.8484946,49.0017627],[15.7793219,48.9741343],[15.7608759,48.9511755],[15.6805038,48.9461167],[15.6310948,48.9383341],[15.5915676,48.9511755],[15.5830034,48.967519],[15.5546755,48.9768582],[15.506584,49.0029301],[15.5342531,49.0270563],[15.5645573,49.0756979],[15.6007906,49.0803675],[15.5586282,49.1356244],[15.4861616,49.1247286],[15.416989,49.1360135],[15.3497927,49.1745376],[15.3570394,49.1986639],[15.333323,49.219677],[15.2160589,49.2130618],[15.1745553,49.2009987],[15.1534741,49.2060574],[15.1350281,49.2270706],[15.1067003,49.2247358],[15.1080178,49.2469163],[15.0309397,49.2698751],[14.9769192,49.2624816],[14.9578144,49.2885535],[14.9169696,49.3177385],[14.9228986,49.3360277],[14.9070878,49.3578191],[14.9077465,49.4122977],[14.9308041,49.457048],[14.9235574,49.4963504],[14.9472738,49.5115266],[14.9413447,49.5434354],[14.9446386,49.5776791],[14.9835071,49.5842944],[14.9756016,49.6068641],[15.05795,49.6014162],[15.098136,49.6064749],[15.1554505,49.6021945],[15.2305522,49.6228185],[15.2443868,49.6391621],[15.240434,49.6605644],[15.1850959,49.6831341],[15.1883899,49.7099842],[15.2180353,49.7325539],[15.2338462,49.764852],[15.2937958,49.7667976],[15.3517691,49.7780825],[15.3833909,49.7975391],[15.4334587,49.808824],[15.4308235,49.8298371],[15.4472932,49.8539634],[15.4723271,49.8496829],[15.5019725,49.8594112],[15.5803682,49.8053218],[15.6376827,49.8033761],[15.6864329,49.7928695],[15.7114668,49.7780825],[15.7615347,49.7640737],[15.7826159,49.7426714],[15.8610115,49.7290518],[15.8629879,49.7022016],[15.8787988,49.6913059],[15.9051503,49.6994777],[15.9506066,49.6955863],[15.967735,49.7045364],[15.9716878,49.7278844],[15.9993568,49.7391692],[16.0125326,49.7232148],[16.091587,49.7158212],[16.1093743,49.6909167],[16.1370433,49.6936407],[16.2319087,49.6714601],[16.2872468,49.6251533],[16.3188686,49.6274881],[16.3504904,49.6165924],[16.3939703,49.5784574]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":7,"NAME_1":"Liberecký","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Reichenberg| Liberec"},"geometry":{"type":"Polygon","coordinates":[[[15.4874792,50.7906058],[15.5368883,50.7349598],[15.5296416,50.7123901],[15.5480876,50.629894],[15.5704864,50.6139395],[15.5494052,50.574248],[15.5968379,50.5318325],[15.5915676,50.5178238],[15.5276652,50.5080954],[15.4894556,50.509652],[15.4769386,50.5322217],[15.4558574,50.5326108],[15.4202829,50.5049824],[15.416989,50.4851366],[15.3886611,50.477354],[15.3563806,50.4886388],[15.2483395,50.512765],[15.2074947,50.4898062],[15.1686262,50.5022585],[15.1396396,50.5205477],[15.1165821,50.5248282],[15.10143,50.5485652],[15.0526797,50.5691893],[15.0223755,50.5882568],[14.9584731,50.5995416],[14.9176283,50.6158852],[14.8925944,50.5843655],[14.8583375,50.5719132],[14.8418678,50.5462305],[14.7918,50.5131542],[14.7272389,50.5092628],[14.7035225,50.4870823],[14.6409377,50.4738518],[14.5994342,50.4722952],[14.5763766,50.5007019],[14.5487075,50.4956432],[14.4683355,50.4975889],[14.4406665,50.5131542],[14.3721526,50.6014873],[14.3484363,50.6427354],[14.3787405,50.6645268],[14.3892811,50.7073314],[14.4380313,50.7213402],[14.4314434,50.7392403],[14.4531834,50.7610317],[14.4518658,50.7843797],[14.4650416,50.8011124],[14.5157682,50.7816557],[14.5467312,50.7812666],[14.5744002,50.8158994],[14.6415965,50.8478083],[14.7120868,50.8408039],[14.7107692,50.8267951],[14.7924588,50.832243],[14.8300097,50.8692106],[14.9143344,50.8777715],[14.9439798,50.8657084],[15.0006355,50.8727128],[14.9966828,50.9042326],[14.9802131,50.926024],[15.0144701,50.9412002],[15.008541,50.99062],[14.9729665,50.9890635],[14.9848246,51.0120223],[15.0118349,51.0268094],[15.0414803,51.0147462],[15.0987948,51.0174702],[15.0935245,50.9991809],[15.169285,51.0205832],[15.1732378,50.984783],[15.2364813,50.996457],[15.2740322,50.9801134],[15.2911607,50.9493719],[15.2707382,50.9392545],[15.274691,50.9034543],[15.3069715,50.8641519],[15.3359582,50.8610388],[15.3662624,50.8443061],[15.3728503,50.7812666],[15.4011781,50.7781536],[15.4209417,50.7968319],[15.447952,50.8069494],[15.4874792,50.7906058]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":8,"NAME_1":"Moravskoslezský","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Mährisch-Ostrau|Mähren|Morava|Moravie|Mor via|Moravskoslezský|Ostravský| Moravian-Silesian"},"geometry":{"type":"Polygon","coordinates":[[[18.4441159,49.4010129],[18.4250111,49.4239717],[18.3650614,49.4757264],[18.3202639,49.4998526],[18.2991827,49.5263136],[18.2576791,49.5208657],[18.2095877,49.5270919],[18.171378,49.5469376],[18.1140635,49.5504398],[18.0653133,49.5473268],[18.0224921,49.5321506],[17.9862588,49.5609464],[17.9184038,49.5644486],[17.9072044,49.5901314],[17.8630656,49.5866292],[17.8643832,49.6185381],[17.8294675,49.6403295],[17.7675415,49.6590079],[17.7596361,49.6846906],[17.71945,49.6897493],[17.6851931,49.7103734],[17.6799228,49.7469519],[17.6430307,49.7609606],[17.5969156,49.7566802],[17.5336721,49.7757477],[17.5106145,49.7629063],[17.4816279,49.7625172],[17.4210195,49.779639],[17.3887389,49.7955934],[17.3742456,49.8150501],[17.3386711,49.8240001],[17.2951911,49.811937],[17.2470997,49.8368415],[17.20889,49.8380089],[17.1950555,49.8582438],[17.1476228,49.8745874],[17.1397174,49.8936549],[17.159481,49.9430747],[17.1792446,49.9547487],[17.159481,49.976151],[17.1443289,50.0166208],[17.1581634,50.0399688],[17.1950555,50.0679863],[17.2062549,50.1107909],[17.2220657,50.1341389],[17.2082312,50.1508716],[17.2945323,50.1944545],[17.3953268,50.2337569],[17.4236546,50.2528244],[17.4717461,50.2703354],[17.5975744,50.2730593],[17.6193144,50.2644984],[17.6535713,50.2742267],[17.6878283,50.2975746],[17.7075919,50.3205335],[17.7293318,50.3030225],[17.731967,50.2489331],[17.7609536,50.2360917],[17.7550245,50.2045719],[17.7062743,50.1987349],[17.7075919,50.1808348],[17.6654295,50.1800566],[17.6450071,50.1703283],[17.589669,50.1644913],[17.5903278,50.1512607],[17.6476422,50.1251889],[17.6555477,50.1076779],[17.6970513,50.1131257],[17.7398724,50.0960039],[17.7405312,50.0823843],[17.7780821,50.020123],[17.8136566,50.0026121],[17.8288087,49.9851011],[17.8564778,49.9765402],[17.9263092,49.9780967],[17.9875764,50.0150643],[18.05082,50.0030012],[18.0488436,50.0388014],[18.00734,50.0337427],[18.0205158,50.060982],[18.0481848,50.0570906],[18.091006,50.0395797],[18.1054993,50.0263491],[18.0989114,50.0080599],[18.1134047,49.9948294],[18.2109052,50.0010555],[18.2194695,49.9652553],[18.2675609,49.9660336],[18.2833718,49.9302334],[18.3255342,49.917392],[18.3452978,49.9356812],[18.4223759,49.9325682],[18.4928661,49.9018267],[18.5343697,49.9026049],[18.5547921,49.9208942],[18.5752145,49.9212833],[18.5699442,49.8668047],[18.6048599,49.8582438],[18.5778497,49.8399546],[18.6285763,49.7551236],[18.6298939,49.7142647],[18.6582217,49.7057038],[18.7063132,49.7107625],[18.734641,49.6843015],[18.7972258,49.6846906],[18.8110603,49.6761297],[18.8255536,49.6356599],[18.8268712,49.5951901],[18.8558578,49.5368202],[18.8426821,49.5263136],[18.7978846,49.5169744],[18.7497931,49.4959613],[18.6687623,49.5056896],[18.6200121,49.5029656],[18.5580861,49.512694],[18.5363461,49.4932373],[18.5337109,49.4675546],[18.5099946,49.4387587],[18.4441159,49.4010129]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":9,"NAME_1":"Olomoucký","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Olmütz|Olomouc"},"geometry":{"type":"Polygon","coordinates":[[[17.4236546,50.2528244],[17.3953268,50.2337569],[17.2945323,50.1944545],[17.2082312,50.1508716],[17.2220657,50.1341389],[17.2062549,50.1107909],[17.1950555,50.0679863],[17.1581634,50.0399688],[17.1443289,50.0166208],[17.159481,49.976151],[17.1792446,49.9547487],[17.159481,49.9430747],[17.1397174,49.8936549],[17.1476228,49.8745874],[17.1950555,49.8582438],[17.20889,49.8380089],[17.2470997,49.8368415],[17.2951911,49.811937],[17.3386711,49.8240001],[17.3742456,49.8150501],[17.3887389,49.7955934],[17.4210195,49.779639],[17.4816279,49.7625172],[17.5106145,49.7629063],[17.5336721,49.7757477],[17.5969156,49.7566802],[17.6430307,49.7609606],[17.6799228,49.7469519],[17.6851931,49.7103734],[17.71945,49.6897493],[17.7596361,49.6846906],[17.7675415,49.6590079],[17.8294675,49.6403295],[17.8643832,49.6185381],[17.8630656,49.5866292],[17.9072044,49.5901314],[17.9184038,49.5644486],[17.8992989,49.5329289],[17.8531838,49.5364311],[17.8143154,49.5259245],[17.7978457,49.4726133],[17.7682003,49.451211],[17.7398724,49.4438175],[17.6977101,49.4632741],[17.6753113,49.4640524],[17.6324901,49.4457631],[17.6443483,49.4196912],[17.6054799,49.4068499],[17.5758344,49.4126869],[17.5139085,49.4021803],[17.4763576,49.3784432],[17.4249722,49.3877824],[17.3900565,49.3881715],[17.3551408,49.4080173],[17.3373535,49.3842802],[17.3571171,49.3659909],[17.3492117,49.3492582],[17.320225,49.3375842],[17.283333,49.3072319],[17.1963731,49.2940014],[17.1278592,49.3434212],[17.0797677,49.3570409],[17.0646156,49.3722171],[17.0804265,49.3920628],[17.0455108,49.4006237],[16.9895139,49.451211],[16.9769969,49.4800068],[16.9585509,49.4916808],[16.8953073,49.4916808],[16.8781789,49.4753372],[16.890037,49.4547132],[16.9190237,49.4352566],[16.893331,49.3967324],[16.8564389,49.3881715],[16.8208644,49.4060716],[16.8267935,49.4480979],[16.8063711,49.4768938],[16.8103238,49.5313723],[16.7595972,49.5430463],[16.7675026,49.5683399],[16.8090062,49.5854618],[16.791219,49.6080315],[16.8070299,49.6298229],[16.8017596,49.65356],[16.8432631,49.6823558],[16.8432631,49.7158212],[16.8070299,49.7523997],[16.7826547,49.7862543],[16.7609148,49.8045435],[16.7582796,49.8220545],[16.7352221,49.8360632],[16.7365396,49.8594112],[16.7655263,49.8749765],[16.747739,49.9306225],[16.7299518,49.9563053],[16.7187524,50.0033903],[16.7464214,50.0076708],[16.8083474,50.0500862],[16.800442,50.069932],[16.8142765,50.0917234],[16.7997832,50.1146823],[16.8228407,50.1306367],[16.8439219,50.1703283],[16.8696146,50.1952327],[16.893331,50.2232503],[16.9559157,50.2248068],[17.0125714,50.2174133],[17.0185005,50.2357025],[17.0079599,50.2940725],[16.9433988,50.310416],[16.9124358,50.354388],[16.9104594,50.3859078],[16.8742261,50.39836],[16.8663207,50.4115905],[16.8788377,50.439219],[16.9282467,50.4361059],[16.9783145,50.4193732],[17.0204769,50.4205406],[17.035629,50.4076992],[17.0988726,50.4049753],[17.1357646,50.3789034],[17.1917615,50.3847404],[17.1858325,50.3664511],[17.2727924,50.3193661],[17.3287893,50.3209226],[17.3505292,50.3123617],[17.3380123,50.2847333],[17.3663401,50.2812311],[17.4078437,50.2866789],[17.4236546,50.2528244]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":10,"NAME_1":"Pardubický","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Pardubitz|Pardubice"},"geometry":{"type":"Polygon","coordinates":[[[16.8696146,50.1952327],[16.8439219,50.1703283],[16.8228407,50.1306367],[16.7997832,50.1146823],[16.8142765,50.0917234],[16.800442,50.069932],[16.8083474,50.0500862],[16.7464214,50.0076708],[16.7187524,50.0033903],[16.7299518,49.9563053],[16.747739,49.9306225],[16.7655263,49.8749765],[16.7365396,49.8594112],[16.7352221,49.8360632],[16.7582796,49.8220545],[16.7609148,49.8045435],[16.7826547,49.7862543],[16.8070299,49.7523997],[16.8432631,49.7158212],[16.8432631,49.6823558],[16.8017596,49.65356],[16.8070299,49.6298229],[16.791219,49.6080315],[16.7615735,49.6091989],[16.6910833,49.6290446],[16.5725016,49.6337142],[16.5474677,49.6239859],[16.5375859,49.5990814],[16.5059641,49.5932444],[16.4842242,49.6025836],[16.4203218,49.5959684],[16.3939703,49.5784574],[16.3504904,49.6165924],[16.3188686,49.6274881],[16.2872468,49.6251533],[16.2319087,49.6714601],[16.1370433,49.6936407],[16.1093743,49.6909167],[16.091587,49.7158212],[16.0125326,49.7232148],[15.9993568,49.7391692],[15.9716878,49.7278844],[15.967735,49.7045364],[15.9506066,49.6955863],[15.9051503,49.6994777],[15.8787988,49.6913059],[15.8629879,49.7022016],[15.8610115,49.7290518],[15.7826159,49.7426714],[15.7615347,49.7640737],[15.7114668,49.7780825],[15.6864329,49.7928695],[15.6376827,49.8033761],[15.5803682,49.8053218],[15.5019725,49.8594112],[15.4980198,49.8948223],[15.531618,49.9142789],[15.5309592,49.9551379],[15.5184422,49.9679792],[15.475621,49.9804315],[15.4617865,50.0061142],[15.3899787,50.0251817],[15.373509,50.0380231],[15.4123775,50.0742125],[15.3998605,50.1084561],[15.4380702,50.1057322],[15.4677156,50.0960039],[15.5046077,50.1096235],[15.5118543,50.1240215],[15.5559931,50.137252],[15.5876149,50.1271345],[15.6383415,50.1279128],[15.6686457,50.1216867],[15.7114668,50.1279128],[15.735842,50.1594325],[15.7845922,50.1609891],[15.7931564,50.1333606],[15.8669406,50.1407542],[15.8952685,50.1652695],[15.9598296,50.1539847],[15.9795932,50.1380302],[15.9947453,50.1068996],[16.0336138,50.1065105],[16.0685295,50.0827734],[16.1120094,50.0664298],[16.1449488,50.0458058],[16.1693239,50.0407471],[16.2207093,50.0477514],[16.2734123,50.0341318],[16.3023989,50.0368557],[16.3037165,50.0613711],[16.3320443,50.0808277],[16.3445613,50.1041757],[16.450626,50.1411433],[16.463143,50.1598217],[16.5171635,50.1477586],[16.583701,50.148926],[16.6357452,50.1068996],[16.6713197,50.099117],[16.725999,50.1096235],[16.738516,50.1325824],[16.7595972,50.1333606],[16.7859487,50.152039],[16.8043947,50.1890066],[16.8386516,50.2034045],[16.8696146,50.1952327]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":11,"NAME_1":"Plzeňský","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Pilsen|Plzeň"},"geometry":{"type":"Polygon","coordinates":[[[13.4228403,50.0847191],[13.4379924,50.069932],[13.420864,50.0364666],[13.5124354,50.0388014],[13.5308814,50.0177882],[13.5934662,49.9952185],[13.6646152,49.9948294],[13.6922843,49.9823771],[13.7087539,49.9617531],[13.754869,49.9617531],[13.7660684,49.9426856],[13.7924199,49.9426856],[13.8286532,49.923229],[13.8398526,49.8741983],[13.8154775,49.8605786],[13.8049369,49.8380089],[13.8128423,49.8138827],[13.807572,49.7605715],[13.8260181,49.7508432],[13.776609,49.7271061],[13.7403757,49.7243822],[13.6975546,49.7080386],[13.6856964,49.6913059],[13.7298351,49.674184],[13.714683,49.6282664],[13.7509163,49.6181489],[13.7588218,49.556666],[13.7785854,49.542268],[13.7930787,49.5095809],[13.7647509,49.4916808],[13.7884672,49.462885],[13.7970314,49.4352566],[13.7733151,49.4076281],[13.8042781,49.3679366],[13.7779266,49.3274668],[13.7482812,49.3122906],[13.7436697,49.2877753],[13.7232473,49.2764904],[13.736423,49.2582012],[13.7133655,49.2274597],[13.7311527,49.1982747],[13.7094127,49.169868],[13.6507807,49.1399048],[13.6046656,49.1418505],[13.5980777,49.1002133],[13.6204765,49.0690827],[13.6185001,49.0558522],[13.5710674,49.0360064],[13.5545978,49.0021518],[13.5835844,48.9682973],[13.510459,48.9682973],[13.4893778,48.9441711],[13.4663203,48.9609038],[13.4090058,48.9799713],[13.4037355,49.0519608],[13.3819955,49.0597435],[13.3391744,49.0971002],[13.2956944,49.1200591],[13.244309,49.1142221],[13.1804067,49.1445744],[13.1863357,49.166755],[13.1461497,49.1893247],[13.1178219,49.1963291],[13.114528,49.2188988],[13.0960819,49.2434141],[13.0723656,49.2480837],[13.0611662,49.2671512],[13.0381086,49.2675404],[13.0334971,49.3087884],[13.0097808,49.3095667],[12.9531251,49.3480908],[12.8767058,49.3543169],[12.8483779,49.3473126],[12.8029216,49.3480908],[12.7587829,49.3819454],[12.7594417,49.4002346],[12.7403369,49.4107412],[12.6612824,49.4321435],[12.6421776,49.5072461],[12.6461303,49.5309832],[12.5960625,49.5364311],[12.588157,49.5438246],[12.569711,49.609588],[12.5255722,49.6321577],[12.5315013,49.6434426],[12.5275486,49.6878037],[12.4992208,49.6881928],[12.4511293,49.703369],[12.4313657,49.7329431],[12.4083081,49.7450062],[12.4089669,49.7660194],[12.4656226,49.785476],[12.4682578,49.8138827],[12.4840687,49.8430676],[12.5163492,49.8613569],[12.5196432,49.8843157],[12.5512649,49.9049397],[12.6019916,49.8956006],[12.6481067,49.9026049],[12.6731406,49.8905418],[12.7423132,49.9220616],[12.8154386,49.9228398],[12.9313851,49.9135007],[12.9557603,49.9275094],[12.9682772,49.9590292],[13.0157099,49.9683684],[13.0499668,49.9847119],[13.0881765,50.0146752],[13.1323152,50.0154534],[13.1764539,49.9987207],[13.2060994,49.9792641],[13.2364036,49.9921055],[13.2298157,50.0181774],[13.2943768,50.0567015],[13.3095289,50.10223],[13.3694786,50.0870538],[13.3905598,50.0738233],[13.4228403,50.0847191]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":12,"NAME_1":"Prague","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Prag |Hlavní město Praha"},"geometry":{"type":"Polygon","coordinates":[[[14.5994342,50.140365],[14.6218329,50.1251889],[14.6646541,50.119741],[14.7180158,50.0819951],[14.711428,50.069932],[14.6541135,50.0598146],[14.6692656,50.0345209],[14.6666304,50.0146752],[14.6475256,49.999499],[14.6066808,50.0061142],[14.5500251,50.005336],[14.4591125,49.9683684],[14.4189265,49.9648662],[14.3945514,49.9442421],[14.3570005,49.9419073],[14.3451423,49.9543596],[14.3543653,49.9800424],[14.3247199,49.9917163],[14.3174733,50.0173991],[14.2660879,50.0504754],[14.2924394,50.0679863],[14.2542297,50.0948365],[14.2641115,50.1092344],[14.3168145,50.119741],[14.3602944,50.1181845],[14.3846696,50.1407542],[14.4169501,50.1395868],[14.441984,50.1528173],[14.5342142,50.1707174],[14.5994342,50.140365]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":13,"NAME_1":"Středočeský","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Central Bohemian"},"geometry":{"type":"Polygon","coordinates":[[[15.4380702,50.1057322],[15.3998605,50.1084561],[15.4123775,50.0742125],[15.373509,50.0380231],[15.3899787,50.0251817],[15.4617865,50.0061142],[15.475621,49.9804315],[15.5184422,49.9679792],[15.5309592,49.9551379],[15.531618,49.9142789],[15.4980198,49.8948223],[15.5019725,49.8594112],[15.4723271,49.8496829],[15.4472932,49.8539634],[15.4308235,49.8298371],[15.4334587,49.808824],[15.3833909,49.7975391],[15.3517691,49.7780825],[15.2937958,49.7667976],[15.2338462,49.764852],[15.2180353,49.7325539],[15.1883899,49.7099842],[15.1850959,49.6831341],[15.240434,49.6605644],[15.2443868,49.6391621],[15.2305522,49.6228185],[15.1554505,49.6021945],[15.098136,49.6064749],[15.05795,49.6014162],[14.9756016,49.6068641],[14.9835071,49.5842944],[14.9446386,49.5776791],[14.9413447,49.5434354],[14.8827126,49.5745661],[14.8675605,49.5983032],[14.8306684,49.5963575],[14.7753303,49.6162033],[14.7470025,49.6045293],[14.7331679,49.5850726],[14.7377795,49.5543312],[14.7074752,49.5446028],[14.6574074,49.5138614],[14.5921875,49.5387659],[14.5500251,49.5352637],[14.5151094,49.5453811],[14.4768997,49.5372093],[14.4353962,49.5535529],[14.3859871,49.5352637],[14.3497538,49.5360419],[14.2944157,49.565616],[14.2403952,49.5609464],[14.2074558,49.5379876],[14.1310365,49.5325397],[14.0961208,49.5340963],[14.0585699,49.556666],[14.0262893,49.5473268],[13.9854445,49.5130831],[13.9366943,49.5045222],[13.8839913,49.5239788],[13.7930787,49.5095809],[13.7785854,49.542268],[13.7588218,49.556666],[13.7509163,49.6181489],[13.714683,49.6282664],[13.7298351,49.674184],[13.6856964,49.6913059],[13.6975546,49.7080386],[13.7403757,49.7243822],[13.776609,49.7271061],[13.8260181,49.7508432],[13.807572,49.7605715],[13.8128423,49.8138827],[13.8049369,49.8380089],[13.8154775,49.8605786],[13.8398526,49.8741983],[13.8286532,49.923229],[13.7924199,49.9426856],[13.7660684,49.9426856],[13.754869,49.9617531],[13.7087539,49.9617531],[13.6922843,49.9823771],[13.6646152,49.9948294],[13.5934662,49.9952185],[13.5308814,50.0177882],[13.5124354,50.0388014],[13.420864,50.0364666],[13.4379924,50.069932],[13.4228403,50.0847191],[13.4623676,50.0998952],[13.4972833,50.1279128],[13.510459,50.1524281],[13.553939,50.1777218],[13.6152062,50.1855044],[13.6712031,50.2181916],[13.7555278,50.2150785],[13.767386,50.2306438],[13.8194302,50.2493222],[13.8774035,50.2360917],[13.8833325,50.2621636],[13.9525052,50.2757832],[13.9683161,50.2948507],[14.0071845,50.3026334],[13.9986203,50.3271487],[14.0131136,50.3403792],[14.0605463,50.3399901],[14.117202,50.3248139],[14.1619995,50.3252031],[14.2002092,50.3388227],[14.2568648,50.3275379],[14.2818988,50.3458271],[14.3609532,50.3469945],[14.3793993,50.3648946],[14.3714938,50.4189841],[14.4116798,50.4228754],[14.4459368,50.4419429],[14.4722882,50.4454451],[14.4801937,50.4719061],[14.4683355,50.4975889],[14.5487075,50.4956432],[14.5763766,50.5007019],[14.5994342,50.4722952],[14.6409377,50.4738518],[14.7035225,50.4870823],[14.7272389,50.5092628],[14.7918,50.5131542],[14.8418678,50.5462305],[14.8583375,50.5719132],[14.8925944,50.5843655],[14.9176283,50.6158852],[14.9584731,50.5995416],[15.0223755,50.5882568],[15.0526797,50.5691893],[15.10143,50.5485652],[15.1165821,50.5248282],[15.1396396,50.5205477],[15.1159233,50.4968106],[15.1389808,50.4816344],[15.141616,50.4512821],[15.1567681,50.4147036],[15.1251463,50.3847404],[15.1244875,50.3691751],[15.1547917,50.3403792],[15.2074947,50.327927],[15.2200116,50.2936833],[15.3082891,50.2862898],[15.3478163,50.2967964],[15.3761442,50.2862898],[15.3847084,50.2563266],[15.3807557,50.228309],[15.3959078,50.2080741],[15.3926139,50.1788892],[15.373509,50.1656587],[15.3728503,50.1450346],[15.4360938,50.1251889],[15.4380702,50.1057322]],[[14.5994342,50.140365],[14.5342142,50.1707174],[14.441984,50.1528173],[14.4169501,50.1395868],[14.3846696,50.1407542],[14.3602944,50.1181845],[14.3168145,50.119741],[14.2641115,50.1092344],[14.2542297,50.0948365],[14.2924394,50.0679863],[14.2660879,50.0504754],[14.3174733,50.0173991],[14.3247199,49.9917163],[14.3543653,49.9800424],[14.3451423,49.9543596],[14.3570005,49.9419073],[14.3945514,49.9442421],[14.4189265,49.9648662],[14.4591125,49.9683684],[14.5500251,50.005336],[14.6066808,50.0061142],[14.6475256,49.999499],[14.6666304,50.0146752],[14.6692656,50.0345209],[14.6541135,50.0598146],[14.711428,50.069932],[14.7180158,50.0819951],[14.6646541,50.119741],[14.6218329,50.1251889],[14.5994342,50.140365]]]}},{"type":"Feature","properties":{"id":{},"ID_0":62,"ISO":"CZE","NAME_0":"Czech Republic","ID_1":14,"NAME_1":"Zlínský","TYPE_1":"Kraj","ENGTYPE_1":"Region","NL_NAME_1":"","VARNAME_1":"Gottwaldov|Zlín"},"geometry":{"type":"Polygon","coordinates":[[[18.4441159,49.4010129],[18.3986596,49.3920628],[18.3960244,49.3570409],[18.3617675,49.3329146],[18.3110409,49.3122906],[18.2076113,49.2943905],[18.1582023,49.2722099],[18.1199926,49.1854333],[18.1074757,49.1391266],[18.1180163,49.1278417],[18.1068169,49.0811458],[18.0831005,49.0511826],[18.0442321,49.0313368],[17.9618837,49.0278346],[17.9236741,49.0192737],[17.8907347,48.9893105],[17.8815117,48.9359993],[17.8683359,48.9274384],[17.7754469,48.9196557],[17.7280143,48.8803533],[17.6865107,48.8601184],[17.6911222,48.8698467],[17.6127265,48.926271],[17.5659526,48.9535103],[17.5237903,48.9538994],[17.4895333,48.9356101],[17.4644994,48.9632386],[17.4539588,48.9896996],[17.4071849,48.9943692],[17.3926916,49.0138258],[17.3656813,49.0266672],[17.3281305,49.0223867],[17.3123196,49.0309477],[17.2543463,49.0422325],[17.2378766,49.0760871],[17.2069136,49.0702501],[17.1489404,49.0745305],[17.1482816,49.1025481],[17.1858325,49.1138329],[17.1897852,49.1321222],[17.2286536,49.1480766],[17.2227245,49.1788181],[17.1858325,49.1764833],[17.1588222,49.2585903],[17.1963731,49.2940014],[17.283333,49.3072319],[17.320225,49.3375842],[17.3492117,49.3492582],[17.3571171,49.3659909],[17.3373535,49.3842802],[17.3551408,49.4080173],[17.3900565,49.3881715],[17.4249722,49.3877824],[17.4763576,49.3784432],[17.5139085,49.4021803],[17.5758344,49.4126869],[17.6054799,49.4068499],[17.6443483,49.4196912],[17.6324901,49.4457631],[17.6753113,49.4640524],[17.6977101,49.4632741],[17.7398724,49.4438175],[17.7682003,49.451211],[17.7978457,49.4726133],[17.8143154,49.5259245],[17.8531838,49.5364311],[17.8992989,49.5329289],[17.9184038,49.5644486],[17.9862588,49.5609464],[18.0224921,49.5321506],[18.0653133,49.5473268],[18.1140635,49.5504398],[18.171378,49.5469376],[18.2095877,49.5270919],[18.2576791,49.5208657],[18.2991827,49.5263136],[18.3202639,49.4998526],[18.3650614,49.4757264],[18.4250111,49.4239717],[18.4441159,49.4010129]]]}}]},null,null,{"interactive":true,"className":"","stroke":"#555555","color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2,"smoothFactor":1,"noClip":false}]},{"method":"addCircles","args":[[49.8175,50.0343,50.7663,49.5938,50.073658,48.9545,49.7384],[15.473,15.7812,15.0543,17.2509,14.41854,16.7677,13.3736],[42564.0693543275,38768.5903793264,12540.7176828123,59025.2725533733,42713.2578949441,50405.142594779,35643.9391762471],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":2,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},["central Bohemia","east Bohemia","north Bohemia","north Moravia","Prague","south Moravia","west Bohemia"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"setView":[[49.8,15.3],7,[]],"limits":{"lat":[48.9545,50.7663],"lng":[13.3736,17.2509]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
